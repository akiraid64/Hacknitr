# Manufacturer Analytics API Endpoint
# Add this to main.py before "if __name__ == '__main__':"

@app.get("/api/v1/manufacturer/product-analytics", tags=["Manufacturer"])
async def get_product_analytics(user: dict = Depends(get_current_user)):
    """
    Get analytics for manufacturer's products
    Shows which retailers have products and inventory levels
    """
    if user['role'] != 'manufacturer':
        raise HTTPException(status_code=403, detail="Only manufacturers can access analytics")
    
    try:
        from manufacturer_analytics import get_manufacturer_product_analytics
        
        analytics = get_manufacturer_product_analytics(user['id'])
        
        return {
            "status": "success",
            "analytics": analytics
        }
        
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"Error fetching analytics: {str(e)}")
